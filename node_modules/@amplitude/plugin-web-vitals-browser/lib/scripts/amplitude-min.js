var amplitudeWebVitalsPlugin=function(e){"use strict";function t(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((i=i.apply(e,t||[])).next())})}function n(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}"function"==typeof SuppressedError&&SuppressedError;var i=function(e,t){var n=e;try{n=decodeURI(e)}catch(e){null==t||t.error("Malformed URI sequence: ",e)}return n};let r=-1;const o=e=>{addEventListener("pageshow",t=>{t.persisted&&(r=t.timeStamp,e(t))},!0)},a=(e,t,n,i)=>{let r,o;return a=>{t.value>=0&&(a||i)&&(o=t.value-(r??0),(o||void 0===r)&&(r=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,n),e(t)))}},s=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},l=()=>{const e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},u=()=>{const e=l();return e?.activationStart??0},c=(e,t=-1)=>{const n=l();let i="navigate";return r>=0?i="back-forward-cache":n&&(document.prerendering||u()>0?i="prerender":document.wasDiscarded?i="restore":n.type&&(i=n.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:i}},d=new WeakMap;function p(e,t){return d.get(e)||d.set(e,new t),d.get(e)}class f{t;i=0;o=[];h(e){if(e.hadRecentInput)return;const t=this.o[0],n=this.o.at(-1);this.i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}}const h=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){const i=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return i.observe({type:e,buffered:!0,...n}),i}}catch{}},v=e=>{let t=!1;return()=>{t||(e(),t=!0)}};let m=-1;const g=new Set,y=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,b=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(const e of g)e();isFinite(m)||(m="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",b,!0))}},T=()=>{if(m<0){const e=u(),t=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter(t=>"hidden"===t.name&&t.startTime>e)[0]?.startTime;m=t??y(),addEventListener("visibilitychange",b,!0),addEventListener("prerenderingchange",b,!0),o(()=>{setTimeout(()=>{m=y()})})}return{get firstHiddenTime(){return m},onHidden(e){g.add(e)}}},P=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},w=[1800,3e3],A=(e,t={})=>{P(()=>{const n=T();let i,r=c("FCP");const l=h("paint",e=>{for(const t of e)"first-contentful-paint"===t.name&&(l.disconnect(),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-u(),0),r.entries.push(t),i(!0)))});l&&(i=a(e,r,w,t.reportAllChanges),o(n=>{r=c("FCP"),i=a(e,r,w,t.reportAllChanges),s(()=>{r.value=performance.now()-n.timeStamp,i(!0)})}))})},C=[.1,.25];let E=0,L=1/0,S=0;const I=e=>{for(const t of e)t.interactionId&&(L=Math.min(L,t.interactionId),S=Math.max(S,t.interactionId),E=S?(S-L)/7+1:0)};let M;const k=()=>M?E:performance.interactionCount??0;let x=0;class F{u=[];l=new Map;m;p;v(){x=k(),this.u.length=0,this.l.clear()}L(){const e=Math.min(this.u.length-1,Math.floor((k()-x)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&"first-input"!==e.entryType)return;const t=this.u.at(-1);let n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>t.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){const e=this.u.splice(10);for(const t of e)this.l.delete(t.id)}this.p?.(n)}}}const O=e=>{const t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=v(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},R=[200,500],H=(e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const n=T();P(()=>{"interactionCount"in performance||M||(M=h("event",I,{type:"event",buffered:!0,durationThreshold:0}));let i,r=c("INP");const s=p(t,F),l=e=>{O(()=>{for(const t of e)s.h(t);const t=s.L();t&&t.P!==r.value&&(r.value=t.P,r.entries=t.entries,i())})},u=h("event",l,{durationThreshold:t.durationThreshold??40});i=a(e,r,R,t.reportAllChanges),u&&(u.observe({type:"first-input",buffered:!0}),n.onHidden(()=>{l(u.takeRecords()),i(!0)}),o(()=>{s.v(),r=c("INP"),i=a(e,r,R,t.reportAllChanges)}))})};class B{m;h(e){this.m?.(e)}}const q=[2500,4e3],N=[800,1800],V=e=>{document.prerendering?P(()=>V(e)):"complete"!==document.readyState?addEventListener("load",()=>V(e),!0):setTimeout(e)};function j(e){var t,n=(null===(t=e.entries[0])||void 0===t?void 0:t.startTime)||0;return performance.timeOrigin+n}function D(e){return{value:e.value,rating:e.rating,delta:e.delta,navigationType:e.navigationType,id:e.id,timestamp:Math.floor(j(e)),navigationStart:Math.floor(performance.timeOrigin)}}var U=function(){var e,r=null,d=(e="ampIntegrationContext","undefined"!=typeof globalThis&&void 0!==globalThis[e]?globalThis[e]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:void 0),m=null==d?void 0:d.document,g=null==d?void 0:d.location;return{name:"web-vitals-browser",type:"enrichment",setup:function(e,d){return t(void 0,void 0,void 0,function(){var t,y;return n(this,function(n){return void 0===m||(t=i((null==g?void 0:g.href)||"",e.loggerProvider),y={"[Amplitude] Page Domain":(null==g?void 0:g.hostname)||"","[Amplitude] Page Location":t,"[Amplitude] Page Path":i((null==g?void 0:g.pathname)||"",e.loggerProvider),"[Amplitude] Page Title":"undefined"!=typeof document&&document.title||"","[Amplitude] Page URL":i(t.split("?")[0],e.loggerProvider)},((e,t={})=>{P(()=>{const n=T();let i,r=c("LCP");const l=p(t,B),d=e=>{t.reportAllChanges||(e=e.slice(-1));for(const t of e)l.h(t),t.startTime<n.firstHiddenTime&&(r.value=Math.max(t.startTime-u(),0),r.entries=[t],i())},f=h("largest-contentful-paint",d);if(f){i=a(e,r,q,t.reportAllChanges);const n=v(()=>{d(f.takeRecords()),f.disconnect(),i(!0)}),l=e=>{e.isTrusted&&(O(n),removeEventListener(e.type,l,{capture:!0}))};for(const e of["keydown","click","visibilitychange"])addEventListener(e,l,{capture:!0});o(n=>{r=c("LCP"),i=a(e,r,q,t.reportAllChanges),s(()=>{r.value=performance.now()-n.timeStamp,i(!0)})})}})})(function(e){y["[Amplitude] LCP"]=D(e)}),A(function(e){y["[Amplitude] FCP"]=D(e)}),H(function(e){y["[Amplitude] INP"]=D(e)}),((e,t={})=>{const n=T();A(v(()=>{let i,r=c("CLS",0);const l=p(t,f),u=e=>{for(const t of e)l.h(t);l.i>r.value&&(r.value=l.i,r.entries=l.o,i())},d=h("layout-shift",u);d&&(i=a(e,r,C,t.reportAllChanges),n.onHidden(()=>{u(d.takeRecords()),i(!0)}),o(()=>{l.i=0,r=c("CLS",0),i=a(e,r,C,t.reportAllChanges),s(()=>i())}),setTimeout(i))}))})(function(e){y["[Amplitude] CLS"]=D(e)}),((e,t={})=>{let n=c("TTFB"),i=a(e,n,N,t.reportAllChanges);V(()=>{const r=l();r&&(n.value=Math.max(r.responseStart-u(),0),n.entries=[r],i(!0),o(()=>{n=c("TTFB",0),i=a(e,n,N,t.reportAllChanges),i(!0)}))})})(function(e){y["[Amplitude] TTFB"]=D(e)}),r=function(){"hidden"===m.visibilityState&&r&&(d.track("[Amplitude] Web Vitals",y),m.removeEventListener("visibilitychange",r),r=null)},m.addEventListener("visibilitychange",r)),[2]})})},execute:function(e){return t(void 0,void 0,void 0,function(){return n(this,function(t){return[2,e]})})},teardown:function(){return t(void 0,void 0,void 0,function(){return n(this,function(e){return r&&(null==m||m.removeEventListener("visibilitychange",r)),[2]})})}}};return e.VERSION="1.1.4",e.plugin=U,e.webVitalsPlugin=U,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=amplitude-min.js.map
